# NPIV
Replication Matlab codes and data for Chen and Christensen (2017): "Optimal Sup-norm rates and Uniform Inference on Nonlinear Functionals of Nonparametric IV Regression". 

### Replicating the empirical applications
The file "run_app_cs_dwl.m" reproduces the plots of bootstrap uniform confidence bands for exact consumer surplus and deadweight loss for the household gasoline demand application. The file "run_app_engel.m" reproduces the plots of bootstrap uniform confidence bands for the Engel curve application.

For the CS/DL application, the file bhp_filter.R generates the csv file bhp_new.csv.


### Replicating the simulation exercise
The file "run_sim_ucb.m" reproduces the simulation results.
